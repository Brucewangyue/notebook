# Kubernetes

- **[集群环境搭建](集群环境搭建.md)**
- **[资源管理](资源管理.md)**
- **[Pod](Pod.md)**
- **[控制器](控制器.md)**
- **[流量负载](流量负载.md)**
- **[数据存储](数据存储.md)**
- **[安全认证](安全认证)**
- **[Tutorials](Tutorials.md)**



## Kubernetes介绍

#### 应用部署方式演变

![image-20210826164134062](assets/image-20210826164134062.png)

**传统部署时代：**

- 优点：部署简单，无其他技术要求
- 缺点：资源不可隔离，如果一台机器部署了多个应用，某个应用故障导致资源占用大，会殃及其他应用

**虚拟化部署时代：**

- 优点：资源隔离，提供了一定程度的安全性
- 缺点：增加了操作系统，浪费了部分资源，虚拟机管理不够简单

**容器部署时代：**

- 优点：
  - 每个容器的资源隔离，又共享了宿主机的底层基础架构
  - 敏捷应用程序的创建和部署：与使用 VM 镜像相比，提高了容器镜像创建的简便性和效率
  - 持续开发、集成和部署：通过快速简单的回滚（由于镜像不可变性），支持可靠且频繁的 容器镜像构建和部署
  - 关注开发与运维的分离：在构建/发布时而不是在部署时创建应用程序容器镜像， 从而将应用程序与基础架构分离
  - 可观察性：不仅可以显示操作系统级别的信息和指标，还可以显示应用程序的运行状况和其他指标信号
  - 跨开发、测试和生产的环境一致性：在便携式计算机上与在云中相同地运行
  - 跨云和操作系统发行版本的可移植性：可在 Ubuntu、RHEL、CoreOS、本地、 Google Kubernetes Engine 和其他任何地方运行
  - 以应用程序为中心的管理：提高抽象级别，从在虚拟硬件上运行 OS 到使用逻辑资源在 OS 上运行应用程序
  - 松散耦合、分布式、弹性、解放的微服务：应用程序被分解成较小的独立部分， 并且可以动态部署和管理 - 而不是在一台大型单机上整体运行
  - 资源隔离：可预测的应用程序性能
  - 资源利用：高效率和高密度

- 缺点：
  - 学习成本高

#### 容器化部署带来了新问题

- 如果一个容器挂了，怎么样另外一个容器立刻启动替补停机的容器？
- 当并发访问变大的时候，怎样做到横向扩展容器的数量？

#### Kubernetes简介

![image-20210826165723333](assets/image-20210826165723333.png)

[官方简介](https://kubernetes.io/zh/docs/concepts/overview/what-is-kubernetes/)

#### Kubernetes组件

[官方文档](https://kubernetes.io/zh/docs/concepts/overview/components/)

![image-20210826172057046](assets/image-20210826172057046.png)



**K8s组件**

- Master：Control Plane，整个集群的控制中枢
  - API Server：集群的大脑，各个模块之间信息交互都要经过 API Server ，同时也是集群管理的入口
  - Controller Manager：集群的状态管理器，保证Pod或其他资源达到期望值，创建、更新或者删除它所管理的资源
  - Scheduler：集群的调度中心，它会根据指定的一系列条件选择最佳的节点部署资源
  - Etcd：键值数据库，性能强大，保存集群信息
  - Kubelet：建议安装
  - Kube-proxy：建议安装

- Node：Worker
  - Kubelet：负责监听节点上Pod的状态，同时负责上报节点和节点上面Pod的状态，负责与Master通信，并管理节点上面的Pod
  - Kube-proxy：负责Pod之间的通信和负载均衡，将指定的流量分发到后端正确的机器上



**其他组件**

Calico：符合CNI标准的网络插件，给每个Pod生成唯一的IP地址，并且控制每个节点的路由表，管理集群节点的路由和网卡接口，保证Pod和Service的正常通信，支持做网络策略

Cilium：以后可能会流行 eBPF，可以替代Kube-proxy

CoreDNS：用于集群内部Service的解析，可以让Pod把Service的名称解析成IP地址，大概是用于解析资源的名称和IP的映射关系

Docker：容器引擎，负载对容器的管理

Metrics Server：收集集群指标信息