# 分布式锁



## 单机锁

- synchronized
- ReentrantLock
- 自旋锁



## redis

中小项目



## zookeeper



## etcd

redis虽然有红锁，集群模式，但是redis是ap模型，注重的是可用性，对于锁来讲，一致性比(cp)比可用性(ap)更好。

redis红锁在某个节点宕机之前被客户端获取了锁，然后在主机恢复后，客户端的锁假设还未执行完，那么就可能会让一个新的客户端获取到锁

etcd实现了raft共识算法，一致性强



## mysql



### 乐观锁

版本号控制的原理：

为表中加一个 version 字段；
当读取数据时，连同这个 version 字段一起读出；
数据每更新一次就将此值加一；
当提交更新时，判断数据库表中对应记录的当前版本号是否与之前取出来的版本号一致，如果一致则可以直接更新，如果不一致则表示是过期数据需要重试或者做其它操作

### 悲观锁

